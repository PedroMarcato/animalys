<ui:composition template="/WEB-INF/template/Layout.xhtml"
	xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui">

	<ui:define name="titulo">Pesquisa de Retiradas de Ração</ui:define>

	<ui:define name="content">
		<h:form id="formPesquisa">
			<h1 class="aw-page-title">Pesquisa de Retiradas de Ração</h1>

			<p:messages id="messages" closable="true" />
			
			<p:toolbar>
				<p:toolbarGroup>
					<p:commandButton value="Pesquisar" icon="fa fa-search"
						action="#{pesquisaRetiradaRacaoBean.pesquisar()}" 
						update="@form" />
				</p:toolbarGroup>
				<p:toolbarGroup align="right">
					<p:button value="Nova Retirada" icon="fa fa-plus"
						outcome="/estoque/retiradaRacao" />
				</p:toolbarGroup>
			</p:toolbar>

			<div class="ui-fluid">
				<p:panelGrid columns="2" layout="grid"
					columnClasses="ui-grid-col-2, ui-grid-col-6"
					styleClass="panelgrid-noborder">

					<p:outputLabel value="CPF do Proprietário" for="cpfFiltro" />
					<p:inputMask id="cpfFiltro" mask="999.999.999-99"
						value="#{pesquisaRetiradaRacaoBean.cpfProprietario}" />

					<p:outputLabel value="Nome do Animal" for="nomeAnimalFiltro" />
					<p:inputText id="nomeAnimalFiltro"
						value="#{pesquisaRetiradaRacaoBean.nomeAnimal}" />

					<p:outputLabel value="Mês de Referência" for="mesReferenciaFiltro" />
					<p:selectOneMenu id="mesReferenciaFiltro"
						value="#{pesquisaRetiradaRacaoBean.mesReferencia}">
						<f:selectItem itemLabel="Todos os meses" itemValue="#{null}" />
						<f:selectItems value="#{pesquisaRetiradaRacaoBean.mesesReferencia}"
							var="mes" 
							itemValue="#{mes.numero}" 
							itemLabel="#{mes.nome}" />
					</p:selectOneMenu>

					<p:outputLabel value="Ano de Referência" for="anoReferenciaFiltro" />
					<p:selectOneMenu id="anoReferenciaFiltro"
						value="#{pesquisaRetiradaRacaoBean.anoReferencia}">
						<f:selectItem itemLabel="Todos os anos" itemValue="#{null}" />
						<f:selectItems value="#{pesquisaRetiradaRacaoBean.anosReferencia}" />
					</p:selectOneMenu>

				</p:panelGrid>
			</div>

			
			<p:dataTable id="racoesTable" 
				emptyMessage="Nenhuma retirada encontrada" 
				rows="20"
				paginator="true" 
				paginatorAlwaysVisible="false"
				paginatorPosition="bottom" 
				reflow="true"
				value="#{pesquisaRetiradaRacaoBean.retiradasFiltradas}" 
				var="retirada">

				<p:column headerText="Última Retirada" style="width: 110px;">
					<h:outputText value="#{retirada.data12Mes}" rendered="#{not empty retirada.data12Mes}">
						<f:convertDateTime pattern="dd/MM/yyyy" timeZone="America/Sao_Paulo" />
					</h:outputText>
					<h:outputText value="#{retirada.data11Mes}" rendered="#{empty retirada.data12Mes and not empty retirada.data11Mes}">
						<f:convertDateTime pattern="dd/MM/yyyy" timeZone="America/Sao_Paulo" />
					</h:outputText>
					<h:outputText value="#{retirada.data10Mes}" rendered="#{empty retirada.data12Mes and empty retirada.data11Mes and not empty retirada.data10Mes}">
						<f:convertDateTime pattern="dd/MM/yyyy" timeZone="America/Sao_Paulo" />
					</h:outputText>
					<h:outputText value="#{retirada.data9Mes}" rendered="#{empty retirada.data12Mes and empty retirada.data11Mes and empty retirada.data10Mes and not empty retirada.data9Mes}">
						<f:convertDateTime pattern="dd/MM/yyyy" timeZone="America/Sao_Paulo" />
					</h:outputText>
					<h:outputText value="#{retirada.data8Mes}" rendered="#{empty retirada.data12Mes and empty retirada.data11Mes and empty retirada.data10Mes and empty retirada.data9Mes and not empty retirada.data8Mes}">
						<f:convertDateTime pattern="dd/MM/yyyy" timeZone="America/Sao_Paulo" />
					</h:outputText>
					<h:outputText value="#{retirada.data7Mes}" rendered="#{empty retirada.data12Mes and empty retirada.data11Mes and empty retirada.data10Mes and empty retirada.data9Mes and empty retirada.data8Mes and not empty retirada.data7Mes}">
						<f:convertDateTime pattern="dd/MM/yyyy" timeZone="America/Sao_Paulo" />
					</h:outputText>
					<h:outputText value="#{retirada.data6Mes}" rendered="#{empty retirada.data12Mes and empty retirada.data11Mes and empty retirada.data10Mes and empty retirada.data9Mes and empty retirada.data8Mes and empty retirada.data7Mes and not empty retirada.data6Mes}">
						<f:convertDateTime pattern="dd/MM/yyyy" timeZone="America/Sao_Paulo" />
					</h:outputText>
					<h:outputText value="#{retirada.data5Mes}" rendered="#{empty retirada.data12Mes and empty retirada.data11Mes and empty retirada.data10Mes and empty retirada.data9Mes and empty retirada.data8Mes and empty retirada.data7Mes and empty retirada.data6Mes and not empty retirada.data5Mes}">
						<f:convertDateTime pattern="dd/MM/yyyy" timeZone="America/Sao_Paulo" />
					</h:outputText>
					<h:outputText value="#{retirada.data4Mes}" rendered="#{empty retirada.data12Mes and empty retirada.data11Mes and empty retirada.data10Mes and empty retirada.data9Mes and empty retirada.data8Mes and empty retirada.data7Mes and empty retirada.data6Mes and empty retirada.data5Mes and not empty retirada.data4Mes}">
						<f:convertDateTime pattern="dd/MM/yyyy" timeZone="America/Sao_Paulo" />
					</h:outputText>
					<h:outputText value="#{retirada.data3Mes}" rendered="#{empty retirada.data12Mes and empty retirada.data11Mes and empty retirada.data10Mes and empty retirada.data9Mes and empty retirada.data8Mes and empty retirada.data7Mes and empty retirada.data6Mes and empty retirada.data5Mes and empty retirada.data4Mes and not empty retirada.data3Mes}">
						<f:convertDateTime pattern="dd/MM/yyyy" timeZone="America/Sao_Paulo" />
					</h:outputText>
					<h:outputText value="#{retirada.data2Mes}" rendered="#{empty retirada.data12Mes and empty retirada.data11Mes and empty retirada.data10Mes and empty retirada.data9Mes and empty retirada.data8Mes and empty retirada.data7Mes and empty retirada.data6Mes and empty retirada.data5Mes and empty retirada.data4Mes and empty retirada.data3Mes and not empty retirada.data2Mes}">
						<f:convertDateTime pattern="dd/MM/yyyy" timeZone="America/Sao_Paulo" />
					</h:outputText>
					<h:outputText value="#{retirada.data1Mes}" rendered="#{empty retirada.data12Mes and empty retirada.data11Mes and empty retirada.data10Mes and empty retirada.data9Mes and empty retirada.data8Mes and empty retirada.data7Mes and empty retirada.data6Mes and empty retirada.data5Mes and empty retirada.data4Mes and empty retirada.data3Mes and empty retirada.data2Mes and not empty retirada.data1Mes}">
						<f:convertDateTime pattern="dd/MM/yyyy" timeZone="America/Sao_Paulo" />
					</h:outputText>
					<h:outputText value="-" styleClass="text-muted" rendered="#{empty retirada.data1Mes and empty retirada.data2Mes and empty retirada.data3Mes and empty retirada.data4Mes and empty retirada.data5Mes and empty retirada.data6Mes and empty retirada.data7Mes and empty retirada.data8Mes and empty retirada.data9Mes and empty retirada.data10Mes and empty retirada.data11Mes and empty retirada.data12Mes}" />
				</p:column>
				
				<p:column headerText="1ª Retirada" style="width: 110px;">
					<h:outputText value="#{retirada.data1Mes}" rendered="#{not empty retirada.data1Mes}">
						<f:convertDateTime pattern="dd/MM/yyyy" timeZone="America/Sao_Paulo" />
					</h:outputText>
					<h:outputText value="-" styleClass="text-muted" rendered="#{empty retirada.data1Mes}" />
				</p:column>
					
				<p:column headerText="Proprietário">
					<h:outputText value="#{retirada.proprietario.nome}" />
				</p:column>

				<p:column headerText="CPF" style="width: 105px;">
					<h:outputText value="#{retirada.proprietario.cpf}" />
				</p:column>
				
				<p:column headerText="Animal" style="width: 150px;">
					<h:outputText value="#{retirada.animal.nome}" />
				</p:column>
				
				<p:column headerText="Quantidade (Kg)" style="width: 120px;">
					<h:outputText value="#{retirada.quantidade12Mes}" rendered="#{not empty retirada.data12Mes}">
						<f:convertNumber pattern="#0.000" />
					</h:outputText>
					<h:outputText value="#{retirada.quantidade11Mes}" rendered="#{empty retirada.data12Mes and not empty retirada.data11Mes}">
						<f:convertNumber pattern="#0.000" />
					</h:outputText>
					<h:outputText value="#{retirada.quantidade10Mes}" rendered="#{empty retirada.data12Mes and empty retirada.data11Mes and not empty retirada.data10Mes}">
						<f:convertNumber pattern="#0.000" />
					</h:outputText>
					<h:outputText value="#{retirada.quantidade9Mes}" rendered="#{empty retirada.data12Mes and empty retirada.data11Mes and empty retirada.data10Mes and not empty retirada.data9Mes}">
						<f:convertNumber pattern="#0.000" />
					</h:outputText>
					<h:outputText value="#{retirada.quantidade8Mes}" rendered="#{empty retirada.data12Mes and empty retirada.data11Mes and empty retirada.data10Mes and empty retirada.data9Mes and not empty retirada.data8Mes}">
						<f:convertNumber pattern="#0.000" />
					</h:outputText>
					<h:outputText value="#{retirada.quantidade7Mes}" rendered="#{empty retirada.data12Mes and empty retirada.data11Mes and empty retirada.data10Mes and empty retirada.data9Mes and empty retirada.data8Mes and not empty retirada.data7Mes}">
						<f:convertNumber pattern="#0.000" />
					</h:outputText>
					<h:outputText value="#{retirada.quantidade6Mes}" rendered="#{empty retirada.data12Mes and empty retirada.data11Mes and empty retirada.data10Mes and empty retirada.data9Mes and empty retirada.data8Mes and empty retirada.data7Mes and not empty retirada.data6Mes}">
						<f:convertNumber pattern="#0.000" />
					</h:outputText>
					<h:outputText value="#{retirada.quantidade5Mes}" rendered="#{empty retirada.data12Mes and empty retirada.data11Mes and empty retirada.data10Mes and empty retirada.data9Mes and empty retirada.data8Mes and empty retirada.data7Mes and empty retirada.data6Mes and not empty retirada.data5Mes}">
						<f:convertNumber pattern="#0.000" />
					</h:outputText>
					<h:outputText value="#{retirada.quantidade4Mes}" rendered="#{empty retirada.data12Mes and empty retirada.data11Mes and empty retirada.data10Mes and empty retirada.data9Mes and empty retirada.data8Mes and empty retirada.data7Mes and empty retirada.data6Mes and empty retirada.data5Mes and not empty retirada.data4Mes}">
						<f:convertNumber pattern="#0.000" />
					</h:outputText>
					<h:outputText value="#{retirada.quantidade3Mes}" rendered="#{empty retirada.data12Mes and empty retirada.data11Mes and empty retirada.data10Mes and empty retirada.data9Mes and empty retirada.data8Mes and empty retirada.data7Mes and empty retirada.data6Mes and empty retirada.data5Mes and empty retirada.data4Mes and not empty retirada.data3Mes}">
						<f:convertNumber pattern="#0.000" />
					</h:outputText>
					<h:outputText value="#{retirada.quantidade2Mes}" rendered="#{empty retirada.data12Mes and empty retirada.data11Mes and empty retirada.data10Mes and empty retirada.data9Mes and empty retirada.data8Mes and empty retirada.data7Mes and empty retirada.data6Mes and empty retirada.data5Mes and empty retirada.data4Mes and empty retirada.data3Mes and not empty retirada.data2Mes}">
						<f:convertNumber pattern="#0.000" />
					</h:outputText>
					<h:outputText value="#{retirada.quantidade1Mes}" rendered="#{empty retirada.data12Mes and empty retirada.data11Mes and empty retirada.data10Mes and empty retirada.data9Mes and empty retirada.data8Mes and empty retirada.data7Mes and empty retirada.data6Mes and empty retirada.data5Mes and empty retirada.data4Mes and empty retirada.data3Mes and empty retirada.data2Mes and not empty retirada.data1Mes}">
						<f:convertNumber pattern="#0.000" />
					</h:outputText>
					<h:outputText value="-" styleClass="text-muted" rendered="#{empty retirada.data1Mes and empty retirada.data2Mes and empty retirada.data3Mes and empty retirada.data4Mes and empty retirada.data5Mes and empty retirada.data6Mes and empty retirada.data7Mes and empty retirada.data8Mes and empty retirada.data9Mes and empty retirada.data10Mes and empty retirada.data11Mes and empty retirada.data12Mes}" />
				</p:column>
				
				<p:column headerText="Mês de Referência" style="width: 130px;">
					<h:outputText value="#{retirada.mesReferenciaFormatado}" />
				</p:column>
				
				<p:column headerText="Observações">
					<h:outputText value="#{retirada.observacoes}" 
						rendered="#{not empty retirada.observacoes}" />
					<h:outputText value="-" styleClass="text-muted" 
						rendered="#{empty retirada.observacoes}" />
				</p:column>
				
				<p:column headerText="Ações" width="80" styleClass="text-center">
					<p:button icon="fa fa-pencil" title="Editar"
						outcome="/estoque/retiradaRacao" styleClass="btn-sm" style="margin-left: 5px;">
						<f:param name="retirada" value="#{retirada.idRetiradaRacao}" />
					</p:button>
					<p:commandButton icon="fa fa-trash" title="Excluir" 
						styleClass="btn-sm ui-button-danger"
						actionListener="#{pesquisaRetiradaRacaoBean.prepararExclusao(retirada)}"
						process="@this"
						oncomplete="PF('confirmExclusao').show()">
					</p:commandButton>
				</p:column>
				
			</p:dataTable>
			
			<p:confirmDialog message="Tem certeza que deseja excluir esta Retirada de ração?"
				header="Confirmação de Exclusão" severity="alert" 
				widgetVar="confirmExclusao">
				<p:commandButton value="Sim" 
					action="#{pesquisaRetiradaRacaoBean.confirmarExclusao()}"
					update="racoesTable messages"
					oncomplete="PF('confirmExclusao').hide()" />
				<p:commandButton value="Não" type="button" 
					onclick="PF('confirmExclusao').hide()" />
			</p:confirmDialog>		</h:form>
	</ui:define>

</ui:composition>