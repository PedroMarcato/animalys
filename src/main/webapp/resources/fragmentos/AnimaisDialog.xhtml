<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui">

    <p:dialog header="Animais da Solicitação" widgetVar="animaisDialog"
              hideEffect="clip" id="animaisDialog" width="800px">
        <h:form id="formAnimaisDialog">
            <p:dataTable id="animaisTable" style="margin-top: 20px"
                         emptyMessage="Nenhum animal encontrado" rows="10" reflow="true"
                         value="#{consultasRealizadasBean.animaisCarregados}" var="animal">

                <p:column headerText="Nome">
                    <h:outputText value="#{animal.nome}" />
                </p:column>
                <p:column headerText="Espécie" style="width: 120px">
                    <h:outputText value="#{animal.raca.especie.nome}" />
                </p:column>
                <p:column headerText="Raça">
                    <h:outputText value="#{animal.raca.nome}" />
                </p:column>
                <p:column headerText="Idade" style="width: 60px">
                    <h:outputText value="#{animal.idade}" />
                </p:column>
                <p:column headerText="Sexo" style="width: 60px">
                    <h:outputText value="#{animal.sexo}" />
                </p:column>
                <p:column headerText="Foto" style="width: 100px;">
                    <p:commandLink oncomplete="PF('imagemDialog').show();"
                                   action="#{consultasRealizadasBean.selecionarImagem(animal.foto)}"
                                   process="@this"
                                   update=":formAnimaisDialog:imagemDialogContent">
                        <img src="/uploads/#{not empty animal.foto ? animal.foto : 'no_image.jpg'}"
                             width="100"
                             alt="Foto de #{animal.nome}"
                             style="cursor: pointer;" />
                    </p:commandLink>
                </p:column>
            </p:dataTable>

            <!-- Dialog de visualização de imagem dentro do mesmo form -->
            <p:dialog header="Visualização da Imagem"
                      widgetVar="imagemDialog"
                      hideEffect="fade"
                      showEffect="fade"
                      id="imagemDialog"
                      style="max-width: 700px; min-height: 400px;"
                      modal="true"
                      resizable="true">

                <h:panelGroup id="imagemDialogContent">
                    <div style="text-align: center;">
                        <img src="/uploads/#{not empty consultasRealizadasBean.imagemSelecionada ? consultasRealizadasBean.imagemSelecionada : 'no_image.jpg'}"
                             style="max-width: 100%; max-height: 500px;"
                             alt="Imagem ampliada" />
                    </div>
                </h:panelGroup>

            </p:dialog>
        </h:form>
    </p:dialog>

</ui:composition>
